<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    function shuffle(array) {
      let currentIndex = array.length,  randomIndex;

      // While there remain elements to shuffle.
      while (currentIndex != 0) {

        // Pick a remaining element.
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex--;

        // And swap it with the current element.
        [array[currentIndex], array[randomIndex]] = [
          array[randomIndex], array[currentIndex]];
      }

      return array;
    }

    function createArray(len) {
      var newArr = []
      for (let i = 0; i < len; i++) {
        newArr.push(i+1)
      }

      return newArr
    }

    document.addEventListener("DOMContentLoaded", () => {
      var pageForm = document.getElementById("form-generate")

      pageForm.addEventListener("submit", (e) => {
        e.preventDefault()

        const formData = new FormData(e.target)
        const payload = Object.fromEntries(formData)
        const { numberOfPeople, numberPerGroup } = payload
        
        if (numberPerGroup > numberOfPeople) {
          alert(`How the heck do I split ${numberOfPeople} into groups with ${numberPerGroup} people???`)
          return
        }

        // create the array
        var arrayOfPeople = createArray(numberOfPeople)
        shuffle(arrayOfPeople)

        // generate the groups
        var arrayOfGroups = []
        var remainingPeople = arrayOfPeople.length
        var index = 0
        while (remainingPeople >= numberPerGroup) {
          var newGroup = []
          for (let i = 0; i < numberPerGroup; i++) {
            newGroup.push(arrayOfPeople[index])
            remainingPeople--
            index++
          }
          arrayOfGroups.push(newGroup)
        }

        var arrayOfExtras = []
        for (let i = 0; i < remainingPeople; i++) {
          indexFromBack = arrayOfPeople.length - 1 - i
          arrayOfExtras.push(arrayOfPeople[indexFromBack])
        }

        console.log(arrayOfPeople)
        console.log(arrayOfGroups)

        var groupsDiv = document.getElementById("container-groups")
        var groupsHTML = ""
        for (let i = 0; i < arrayOfGroups.length; i++) {
          groupsHTML += `
            <div class="flex shadow-md items-center justify-between font-medium text-lg text-white bg-purple-600 rounded-md py-2 px-4">
              <p>Player ${arrayOfGroups[i][0]}</p>
              <p>+</p>
              <p>Player ${arrayOfGroups[i][1]}</p>
            </div>
          `
        }
        groupsDiv.innerHTML = groupsHTML

        var extrasDiv = document.getElementById("container-extras")
        var extrasHTML = ""
        for (let i = 0; i < arrayOfExtras.length; i++) {
          extrasHTML += `<p class="font-bold text-purple-600">Player ${arrayOfExtras[i]}</p>`
        }
        extrasDiv.innerHTML = extrasHTML
      })
    })
  </script>
</head>

<body>
  <div class="px-2 w-full mx-auto max-w-xs mt-8">
    <p class="font-bold text-6xl text-purple-600 text-center">GROOP</p>
    
    <form id="form-generate">
      <div class="flex flex-col mt-4">
        <input required type="number" class="border-2 rounded-md p-2 text-center" placeholder="How many people?" name="numberOfPeople"/>
        <input required type="number" class="border-2 rounded-md p-2 text-center mt-2" value="2" readonly placeholder="How many per group?" name="numberPerGroup"/>
  
        <input class="border-2 cursor-pointer border-purple-600 rounded-md mt-4 py-2 font-bold text-purple-600" type="submit" />
      </div>
    </form>

    <div class="mt-4">
      <p class="font-bold text-lg">Groups:</p>

      <div class="mt-2 space-y-3" id="container-groups">-</div>
    </div>

    <div class="mt-4">
      <p class="font-bold text-lg">Extras:</p>

      <div class="mt-2 space-y-3" id="container-extras">-</div>
    </div>
  </div>
</body>